<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class PentestResult extends Model
{
    use HasFactory;

    protected $fillable = [
        'session_id',
        'ip_address',
        'module_type',
        'test_name',
        'status',
        'severity',
        'description',
        'details',
        'evidence',
        'recommendation',
        'tested_at'
    ];

    protected $casts = [
        'details' => 'array',
        'evidence' => 'array',
        'tested_at' => 'datetime'
    ];

    public function session()
    {
        return $this->belongsTo(PentestSession::class, 'session_id', 'session_id');
    }

    public function getSeverityColorAttribute()
    {
        return match($this->severity) {
            'critical' => 'danger',
            'high' => 'warning',
            'medium' => 'info',
            'low' => 'secondary',
            'info' => 'light',
            default => 'light'
        };
    }

    public function getStatusColorAttribute()
    {
        return match($this->status) {
            'vulnerable' => 'danger',
            'success' => 'success',
            'failed' => 'secondary',
            'running' => 'primary',
            'pending' => 'warning',
            default => 'light'
        };
    }
}
